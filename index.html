<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel de Acompanhamento</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Painel de Acompanhamento</h1>
  
  <!-- Tabela -->
  <table border="1" id="tabela-dados">
    <thead>
      <tr>
        <th>Data</th>
        <th>Saldo</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Gráfico -->
  <canvas id="grafico"></canvas>

  <script>
    // ID da planilha do aluno
    const sheetID = "1hnzpZ5eQpYIFO7tUSS6GYNF1jp81TXS9OQF_a4Ylgqk";
    const sheetName = "Página1"; // nome da aba
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

    fetch(url)
      .then(res => res.text())
      .then(text => {
        const data = JSON.parse(text.substr(47).slice(0, -2));
        const rows = data.table.rows;

        let datas = [];
        let saldos = [];

        rows.forEach(r => {
          const dataVal = r.c[0].v;
          const saldoVal = r.c[1].v;

          datas.push(dataVal);
          saldos.push(saldoVal);

          document.querySelector("#tabela-dados tbody").innerHTML += `
            <tr>
              <td>${dataVal}</td>
              <td>${saldoVal}</td>
            </tr>
          `;
        });

        // Gráfico
        new Chart(document.getElementById("grafico"), {
          type: "line",
          data: {
            labels: datas,
            datasets: [{
              label: "Saldo",
              data: saldos,
              borderColor: "blue",
              fill: false
            }]
          }
        });
      });
  </script>
</body>
</html>
